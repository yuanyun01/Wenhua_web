<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>数据统计分析 - 城市文化产业宣传与促进平台</title>
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- 图标库 -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
    <!-- ECharts 图表库 -->
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    <!-- 自定义样式 -->
    <link rel="stylesheet" href="css/style.css">
    <style>
        /* 统计卡片样式 */
        .stat-card {
            transition: all 0.3s ease;
            height: 100%;
        }
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.1);
        }
        .stat-card .card-body {
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        .stat-number {
            font-size: 2.5rem;
            font-weight: bold;
            color: #0d6efd;
        }
        .stat-desc {
            color: #6c757d;
            margin-bottom: 0;
        }
        .stat-trend {
            font-size: 0.9rem;
            margin-top: 0.5rem;
        }
        .trend-up {
            color: #198754;
        }
        .trend-down {
            color: #dc3545;
        }
        /* 图表容器样式 */
        .chart-container {
            height: 400px;
            width: 100%;
            margin-bottom: 2rem;
        }
        /* 响应式调整 */
        @media (max-width: 768px) {
            .stat-number {
                font-size: 1.8rem;
            }
            .chart-container {
                height: 300px;
            }
        }
    </style>
</head>
<body>
    <!-- 导航栏 -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark sticky-top">
        <div class="container">
            <a class="navbar-brand" href="index.html">
                <i class="bi bi-building-columns me-2"></i>城市文化平台
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item"><a class="nav-link" href="index.html">首页</a></li>
                    <li class="nav-item"><a class="nav-link" href="culture.html">文化资源</a></li>
                    <li class="nav-item"><a class="nav-link" href="events.html">文化活动</a></li>
                    <li class="nav-item"><a class="nav-link" href="forum.html">互动交流</a></li>
                    <li class="nav-item"><a class="nav-link active" href="statistics.html">数据统计</a></li>
                </ul>
                <div class="d-flex" id="userNav">
                    <a href="login.html" class="btn btn-outline-light me-2">登录</a>
                    <a href="register.html" class="btn btn-primary">注册</a>
                </div>
            </div>
        </div>
    </nav>

    <!-- 页面头部 -->
    <header class="py-5 bg-primary text-white">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-md-8">
                    <h1>数据统计分析中心</h1>
                    <p class="lead">基于平台数据，洞察城市文化产业发展趋势</p>
                </div>
                <div class="col-md-4 text-md-end">
                    <div class="btn-group">
                        <button class="btn btn-light" id="timeRangeMonth">本月</button>
                        <button class="btn btn-light active" id="timeRangeQuarter">本季度</button>
                        <button class="btn btn-light" id="timeRangeYear">本年</button>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- 核心数据概览 -->
    <section class="py-5 bg-light">
        <div class="container">
            <h3 class="mb-4"><i class="bi bi-bar-chart me-2"></i>核心数据概览</h3>
            <div class="row g-4">
                <!-- 用户总数 -->
                <div class="col-md-3 col-sm-6">
                    <div class="card stat-card shadow-sm">
                        <div class="card-body text-center">
                            <i class="bi bi-people fs-3 text-primary mb-2"></i>
                            <div class="stat-number">28,542</div>
                            <p class="stat-desc">平台注册用户</p>
                            <p class="stat-trend trend-up">
                                <i class="bi bi-arrow-up me-1"></i>较上月增长 12.5%
                            </p>
                        </div>
                    </div>
                </div>
                <!-- 活动总数 -->
                <div class="col-md-3 col-sm-6">
                    <div class="card stat-card shadow-sm">
                        <div class="card-body text-center">
                            <i class="bi bi-calendar-event fs-3 text-success mb-2"></i>
                            <div class="stat-number">328</div>
                            <p class="stat-desc">发布文化活动</p>
                            <p class="stat-trend trend-up">
                                <i class="bi bi-arrow-up me-1"></i>较上月增长 8.3%
                            </p>
                        </div>
                    </div>
                </div>
                <!-- 参与人次 -->
                <div class="col-md-3 col-sm-6">
                    <div class="card stat-card shadow-sm">
                        <div class="card-body text-center">
                            <i class="bi bi-ticket-detailed fs-3 text-warning mb-2"></i>
                            <div class="stat-number">156,890</div>
                            <p class="stat-desc">活动参与人次</p>
                            <p class="stat-trend trend-up">
                                <i class="bi bi-arrow-up me-1"></i>较上月增长 18.7%
                            </p>
                        </div>
                    </div>
                </div>
                <!-- 互动量 -->
                <div class="col-md-3 col-sm-6">
                    <div class="card stat-card shadow-sm">
                        <div class="card-body text-center">
                            <i class="bi bi-chat-dots fs-3 text-info mb-2"></i>
                            <div class="stat-number">89,765</div>
                            <p class="stat-desc">用户互动次数</p>
                            <p class="stat-trend trend-up">
                                <i class="bi bi-arrow-up me-1"></i>较上月增长 23.2%
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- 数据可视化图表区 -->
    <section class="py-5">
        <div class="container">
            <!-- 活动类型分布 -->
            <div class="card shadow-sm mb-5">
                <div class="card-header bg-light">
                    <h5 class="mb-0"><i class="bi bi-pie-chart me-2"></i>文化活动类型分布</h5>
                </div>
                <div class="card-body">
                    <div id="eventTypeChart" class="chart-container"></div>
                </div>
            </div>

            <!-- 月度活动参与量趋势 -->
            <div class="card shadow-sm mb-5">
                <div class="card-header bg-light">
                    <h5 class="mb-0"><i class="bi bi-line-chart me-2"></i>月度活动参与量趋势</h5>
                </div>
                <div class="card-body">
                    <div id="monthlyParticipationChart" class="chart-container"></div>
                </div>
            </div>

            <!-- 热门文化资源访问量 -->
            <div class="card shadow-sm mb-5">
                <div class="card-header bg-light">
                    <h5 class="mb-0"><i class="bi bi-bar-chart-fill me-2"></i>热门文化资源访问量TOP10</h5>
                </div>
                <div class="card-body">
                    <div id="hotResourcesChart" class="chart-container"></div>
                </div>
            </div>

            <!-- 用户画像分析 -->
            <div class="card shadow-sm">
                <div class="card-header bg-light">
                    <h5 class="mb-0"><i class="bi bi-person-badge me-2"></i>用户画像分析</h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6 mb-4 mb-md-0">
                            <div id="userAgeChart" class="chart-container"></div>
                        </div>
                        <div class="col-md-6">
                            <div id="userGenderChart" class="chart-container"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- 数据洞察与建议 -->
    <section class="py-5 bg-light">
        <div class="container">
            <h3 class="mb-4"><i class="bi bi-lightbulb me-2"></i>数据洞察与发展建议</h3>
            <div class="card shadow-sm">
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6 mb-4 mb-md-0">
                            <h5 class="text-primary"><i class="bi bi-check-circle me-2"></i>核心发现</h5>
                            <ul class="list-group list-group-flush mt-3">
                                <li class="list-group-item">1. 非遗体验类活动参与度最高，占总活动参与量的38%，用户偏好明显</li>
                                <li class="list-group-item">2. 25-40岁用户是平台核心用户群体，占比达65%，消费能力和参与意愿强</li>
                                <li class="list-group-item">3. 周末和节假日活动预约量显著高于工作日，峰值集中在周六下午</li>
                                <li class="list-group-item">4. 移动端访问占比达82%，需重点优化移动端用户体验</li>
                            </ul>
                        </div>
                        <div class="col-md-6">
                            <h5 class="text-success"><i class="bi bi-lightbulb me-2"></i>发展建议</h5>
                            <ul class="list-group list-group-flush mt-3">
                                <li class="list-group-item">1. 增加非遗体验类活动供给，推出系列化、主题化体验课程</li>
                                <li class="list-group-item">2. 针对25-40岁用户群体，开发更多年轻化、互动性强的文化产品</li>
                                <li class="list-group-item">3. 优化周末活动排期，增加夜间文化活动，提升场馆利用率</li>
                                <li class="list-group-item">4. 加大移动端推广力度，开发小程序版本，提升便捷性</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- 页脚 -->
    <footer class="bg-dark text-light py-4 mt-5">
        <div class="container">
            <div class="row">
                <div class="col-md-6">
                    <h5><i class="bi bi-building-columns me-2"></i>城市文化产业宣传与促进平台</h5>
                    <p>致力于推广城市文化，促进文化产业发展</p>
                </div>
                <div class="col-md-6 text-md-end">
                    <p>© 2026 城市文化平台 版权所有</p>
                    <p>隐私政策 | 服务条款</p>
                </div>
            </div>
        </div>
    </footer>

    <!-- Bootstrap 5 JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- 全局JS -->
    <script src="js/main.js"></script>
    <script>
        // 页面加载完成后初始化图表
        document.addEventListener('DOMContentLoaded', function() {
            // 初始化所有图表
            initEventTypeChart();
            initMonthlyParticipationChart();
            initHotResourcesChart();
            initUserAgeChart();
            initUserGenderChart();
            
            // 时间范围切换事件
            initTimeRangeToggle();
        });

        // 1. 活动类型分布饼图
        function initEventTypeChart() {
            const chartDom = document.getElementById('eventTypeChart');
            const myChart = echarts.init(chartDom);
            
            const option = {
                title: {
                    text: '活动类型占比',
                    left: 'center',
                    textStyle: {
                        fontSize: 14
                    }
                },
                tooltip: {
                    trigger: 'item',
                    formatter: '{a} <br/>{b}: {c} ({d}%)'
                },
                legend: {
                    orient: 'vertical',
                    left: 'left',
                    bottom: '0'
                },
                series: [
                    {
                        name: '活动类型',
                        type: 'pie',
                        radius: ['40%', '70%'],
                        avoidLabelOverlap: false,
                        itemStyle: {
                            borderRadius: 10,
                            borderColor: '#fff',
                            borderWidth: 2
                        },
                        label: {
                            show: false,
                            position: 'center'
                        },
                        emphasis: {
                            label: {
                                show: true,
                                fontSize: 16,
                                fontWeight: 'bold'
                            }
                        },
                        labelLine: {
                            show: false
                        },
                        data: [
                            { value: 38, name: '非遗体验' },
                            { value: 25, name: '文化展览' },
                            { value: 18, name: '戏曲演出' },
                            { value: 12, name: '文化讲座' },
                            { value: 7, name: '其他活动' }
                        ]
                    }
                ],
                color: ['#0d6efd', '#198754', '#ffc107', '#dc3545', '#6c757d']
            };
            
            myChart.setOption(option);
            // 响应窗口大小变化
            window.addEventListener('resize', function() {
                myChart.resize();
            });
        }

        // 2. 月度活动参与量趋势折线图
        function initMonthlyParticipationChart() {
            const chartDom = document.getElementById('monthlyParticipationChart');
            const myChart = echarts.init(chartDom);
            
            const option = {
                title: {
                    text: '近12个月活动参与人次',
                    left: 'center',
                    textStyle: {
                        fontSize: 14
                    }
                },
                tooltip: {
                    trigger: 'axis'
                },
                legend: {
                    data: ['预约人次', '实际参与人次'],
                    bottom: '0'
                },
                grid: {
                    left: '3%',
                    right: '4%',
                    bottom: '15%',
                    top: '10%',
                    containLabel: true
                },
                xAxis: {
                    type: 'category',
                    boundaryGap: false,
                    data: ['1月', '2月', '3月', '4月', '5月', '6月', '7月', '8月', '9月', '10月', '11月', '12月']
                },
                yAxis: {
                    type: 'value',
                    name: '人次'
                },
                series: [
                    {
                        name: '预约人次',
                        type: 'line',
                        data: [8500, 9200, 11500, 13800, 15600, 14200, 18900, 21500, 17800, 19200, 22500, 24800],
                        smooth: true,
                        lineStyle: {
                            width: 3
                        },
                        itemStyle: {
                            color: '#0d6efd'
                        }
                    },
                    {
                        name: '实际参与人次',
                        type: 'line',
                        data: [7200, 8100, 9800, 11500, 13200, 12100, 16500, 18900, 15600, 16800, 19800, 21500],
                        smooth: true,
                        lineStyle: {
                            width: 3
                        },
                        itemStyle: {
                            color: '#198754'
                        }
                    }
                ]
            };
            
            myChart.setOption(option);
            window.addEventListener('resize', function() {
                myChart.resize();
            });
        }

        // 3. 热门文化资源访问量柱状图
        function initHotResourcesChart() {
            const chartDom = document.getElementById('hotResourcesChart');
            const myChart = echarts.init(chartDom);
            
            const option = {
                title: {
                    text: '热门文化资源访问量TOP10',
                    left: 'center',
                    textStyle: {
                        fontSize: 14
                    }
                },
                tooltip: {
                    trigger: 'axis',
                    axisPointer: {
                        type: 'shadow'
                    }
                },
                grid: {
                    left: '3%',
                    right: '4%',
                    bottom: '10%',
                    top: '10%',
                    containLabel: true
                },
                xAxis: {
                    type: 'value',
                    name: '访问量（次）'
                },
                yAxis: {
                    type: 'category',
                    data: ['古琴制作', '传统木雕', '中秋灯会', '端午龙舟节', '市大剧院', '春节庙会', '非遗展示馆', '市文化馆', '市博物馆', '剪纸艺术']
                },
                series: [
                    {
                        name: '访问量',
                        type: 'bar',
                        data: [8500, 9200, 11500, 12800, 13500, 14200, 15600, 16800, 18900, 21500],
                        itemStyle: {
                            color: function(params) {
                                const colorList = ['#0d6efd', '#198754', '#ffc107', '#dc3545', '#6c757d', '#0dcaf0', '#fd7e14', '#6f42c1', '#d63384', '#20c997'];
                                return colorList[params.dataIndex];
                            }
                        },
                        label: {
                            show: true,
                            position: 'right',
                            formatter: '{c}'
                        }
                    }
                ]
            };
            
            myChart.setOption(option);
            window.addEventListener('resize', function() {
                myChart.resize();
            });
        }

        // 4. 用户年龄分布图表
        function initUserAgeChart() {
            const chartDom = document.getElementById('userAgeChart');
            const myChart = echarts.init(chartDom);
            
            const option = {
                title: {
                    text: '用户年龄分布',
                    left: 'center',
                    textStyle: {
                        fontSize: 14
                    }
                },
                tooltip: {
                    trigger: 'item',
                    formatter: '{a} <br/>{b}: {c} ({d}%)'
                },
                series: [
                    {
                        name: '年龄分布',
                        type: 'pie',
                        radius: ['40%', '70%'],
                        data: [
                            { value: 8, name: '18岁以下' },
                            { value: 22, name: '18-25岁' },
                            { value: 43, name: '25-40岁' },
                            { value: 18, name: '40-60岁' },
                            { value: 9, name: '60岁以上' }
                        ],
                        label: {
                            show: true,
                            formatter: '{b}: {d}%'
                        }
                    }
                ],
                color: ['#0d6efd', '#198754', '#ffc107', '#dc3545', '#6c757d']
            };
            
            myChart.setOption(option);
            window.addEventListener('resize', function() {
                myChart.resize();
            });
        }

        // 5. 用户性别分布图表
        function initUserGenderChart() {
            const chartDom = document.getElementById('userGenderChart');
            const myChart = echarts.init(chartDom);
            
            const option = {
                title: {
                    text: '用户性别分布',
                    left: 'center',
                    textStyle: {
                        fontSize: 14
                    }
                },
                tooltip: {
                    trigger: 'item',
                    formatter: '{a} <br/>{b}: {c} ({d}%)'
                },
                series: [
                    {
                        name: '性别分布',
                        type: 'pie',
                        radius: ['40%', '70%'],
                        data: [
                            { value: 58, name: '女性' },
                            { value: 42, name: '男性' }
                        ],
                        label: {
                            show: true,
                            formatter: '{b}: {d}%'
                        }
                    }
                ],
                color: ['#d63384', '#0d6efd']
            };
            
            myChart.setOption(option);
            window.addEventListener('resize', function() {
                myChart.resize();
            });
        }

        // 时间范围切换
        function initTimeRangeToggle() {
            const timeButtons = [
                document.getElementById('timeRangeMonth'),
                document.getElementById('timeRangeQuarter'),
                document.getElementById('timeRangeYear')
            ];
            
            timeButtons.forEach(btn => {
                btn.addEventListener('click', function() {
                    // 切换激活状态
                    timeButtons.forEach(b => {
                        b.classList.remove('active');
                    });
                    this.classList.add('active');
                    
                    // 模拟数据切换（实际项目中可根据时间范围重新加载数据）
                    const timeRange = this.id.replace('timeRange', '');
                    alert(`已切换至${timeRange === 'Month' ? '本月' : timeRange === 'Quarter' ? '本季度' : '本年'}数据视图`);
                    
                    // 重新初始化图表（模拟数据更新）
                    initMonthlyParticipationChart();
                });
            });
        }
    </script>
</body>
</html>